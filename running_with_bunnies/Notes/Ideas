We can use https://en.wikipedia.org/wiki/Johnson's_algorithm to find the optimal route
